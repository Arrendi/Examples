---
output:
  md_document:
    variant: markdown_github
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r init}
base::date()
packageVersion("replyr")
suppressPackageStartupMessages(library("dplyr"))
packageVersion("dplyr")
packageVersion("sparklyr")
devtools::session_info()

sc <- NULL

sc <- sparklyr::spark_connect(version='2.0.2', 
                              master = "local")

print(sc)

mtcars2 <- mtcars %>%
  mutate(car = row.names(mtcars)) 

frameList <- mtcars2 %>% 
  tidyr::gather(key='fact', value='value', -car) %>% 
  split(., .$fact) 

frameListS <- lapply(names(frameList), 
                     function(ni) {
                       copy_to(sc, frameList[[ni]], ni)
                     }
)

tempNameGenerator <- replyr::makeTempNameGenerator("TESTTABS")
```

```{r error, eval=FALSE}
local <- replyr::replyr_bind_rows(frameListS, 
                                 tempNameGenerator = tempNameGenerator()) %>%
  collect() %>%
  as.data.frame()
```



```{r cleanup}
if(!is.null(sc)) {
  sparklyr::spark_disconnect(sc)
}
rm(list=ls())
gc()
```
