<pre><code>## [1] &quot;&quot;
## [1] &quot;***** nSides = 6 kFlips = 1&quot;
## [1] &quot;full rank&quot;
## [1] TRUE
## [1] &quot;bias free determined solution&quot;
## pest for 0 heads pest for 1 heads 
##       -4.491e-16        1.000e+00 
## [1] &quot;standard empirical solution&quot;
## pest for 0 heads pest for 1 heads 
##                0                1 
## [1] &quot;losses for standard empirical solution&quot;
## exp. sq. error for p=0.166666666666667 
##                                 0.1389 
## exp. sq. error for p=0.333333333333333 
##                                 0.2222 
##               exp. sq. error for p=0.5 
##                                 0.2500 
## exp. sq. error for p=0.666666666666667 
##                                 0.2222 
## exp. sq. error for p=0.833333333333333 
##                                 0.1389 
## [1] &quot;Bayes solution&quot;
## pest for 0 heads pest for 1 heads 
##           0.3889           0.6111 
## [1] &quot;losses for Bayes solution&quot;
## exp. sq. error for p=0.166666666666667 
##                                0.07407 
## exp. sq. error for p=0.333333333333333 
##                                0.02778 
##               exp. sq. error for p=0.5 
##                                0.01235 
## exp. sq. error for p=0.666666666666667 
##                                0.02778 
## exp. sq. error for p=0.833333333333333 
##                                0.07407 
## [1] &quot;Bayes max loss improvement&quot;
## [1] 0.1759
## [1] &quot;Bayes solution bias check (failed)&quot;
## bias for p=0.166666666666667 bias for p=0.333333333333333 
##                       0.2593                       0.1296 
##               bias for p=0.5 bias for p=0.666666666666667 
##                       0.0000                      -0.1296 
## bias for p=0.833333333333333 
##                      -0.2593 
## [1] &quot;&quot;
## [1] &quot;&quot;
## [1] &quot;***** nSides = 6 kFlips = 2&quot;
## [1] &quot;full rank&quot;
## [1] TRUE
## [1] &quot;bias free determined solution&quot;
## pest for 0 heads pest for 1 heads pest for 2 heads 
##              0.0              0.5              1.0 
## [1] &quot;standard empirical solution&quot;
## pest for 0 heads pest for 1 heads pest for 2 heads 
##              0.0              0.5              1.0 
## [1] &quot;losses for standard empirical solution&quot;
## exp. sq. error for p=0.166666666666667 
##                                0.06944 
## exp. sq. error for p=0.333333333333333 
##                                0.11111 
##               exp. sq. error for p=0.5 
##                                0.12500 
## exp. sq. error for p=0.666666666666667 
##                                0.11111 
## exp. sq. error for p=0.833333333333333 
##                                0.06944 
## [1] &quot;Bayes solution&quot;
## pest for 0 heads pest for 1 heads pest for 2 heads 
##           0.3182           0.5000           0.6818 
## [1] &quot;losses for Bayes solution&quot;
## exp. sq. error for p=0.166666666666667 
##                                0.05418 
## exp. sq. error for p=0.333333333333333 
##                                0.02594 
##               exp. sq. error for p=0.5 
##                                0.01653 
## exp. sq. error for p=0.666666666666667 
##                                0.02594 
## exp. sq. error for p=0.833333333333333 
##                                0.05418 
## [1] &quot;Bayes max loss improvement&quot;
## [1] 0.07082
## [1] &quot;Bayes solution bias check (failed)&quot;
## bias for p=0.166666666666667 bias for p=0.333333333333333 
##                       0.2121                       0.1061 
##               bias for p=0.5 bias for p=0.666666666666667 
##                       0.0000                      -0.1061 
## bias for p=0.833333333333333 
##                      -0.2121 
## [1] &quot;&quot;
## [1] &quot;&quot;
## [1] &quot;***** nSides = 6 kFlips = 3&quot;
## [1] &quot;full rank&quot;
## [1] TRUE
## [1] &quot;bias free determined solution&quot;
## pest for 0 heads pest for 1 heads pest for 2 heads pest for 3 heads 
##       -2.930e-16        3.333e-01        6.667e-01        1.000e+00 
## [1] &quot;standard empirical solution&quot;
## pest for 0 heads pest for 1 heads pest for 2 heads pest for 3 heads 
##           0.0000           0.3333           0.6667           1.0000 
## [1] &quot;losses for standard empirical solution&quot;
## exp. sq. error for p=0.166666666666667 
##                                0.04630 
## exp. sq. error for p=0.333333333333333 
##                                0.07407 
##               exp. sq. error for p=0.5 
##                                0.08333 
## exp. sq. error for p=0.666666666666667 
##                                0.07407 
## exp. sq. error for p=0.833333333333333 
##                                0.04630 
## [1] &quot;Bayes solution&quot;
## pest for 0 heads pest for 1 heads pest for 2 heads pest for 3 heads 
##           0.2748           0.4111           0.5889           0.7252 
## [1] &quot;losses for Bayes solution&quot;
## exp. sq. error for p=0.166666666666667 
##                                0.04134 
## exp. sq. error for p=0.333333333333333 
##                                0.02390 
##               exp. sq. error for p=0.5 
##                                0.01860 
## exp. sq. error for p=0.666666666666667 
##                                0.02390 
## exp. sq. error for p=0.833333333333333 
##                                0.04134 
## [1] &quot;Bayes max loss improvement&quot;
## [1] 0.04199
## [1] &quot;Bayes solution bias check (failed)&quot;
## bias for p=0.166666666666667 bias for p=0.333333333333333 
##                      0.17937                      0.08853 
##               bias for p=0.5 bias for p=0.666666666666667 
##                      0.00000                     -0.08853 
## bias for p=0.833333333333333 
##                     -0.17937 
## [1] &quot;&quot;
## [1] &quot;&quot;
## [1] &quot;*****&quot;
## [1] &quot;&quot;
## [1] &quot;***** nSides = 6 kFlips = 7&quot;
## [1] 7
## [1] &quot;is full rank&quot;
## [1] FALSE
## [1] &quot;can extend to full rank&quot;
## [1] TRUE
## [1] &quot;confirm null vecs&quot;
## [1] TRUE
## [1] &quot;empirical solution&quot;
## pest for 0 heads pest for 1 heads pest for 2 heads pest for 3 heads 
##           0.0000           0.1429           0.2857           0.4286 
## pest for 4 heads pest for 5 heads pest for 6 heads pest for 7 heads 
##           0.5714           0.7143           0.8571           1.0000 
## [1] &quot;empirical solution losses&quot;
## exp. sq. error for p=0.166666666666667 
##                                0.01984 
## exp. sq. error for p=0.333333333333333 
##                                0.03175 
##               exp. sq. error for p=0.5 
##                                0.03571 
## exp. sq. error for p=0.666666666666667 
##                                0.03175 
## exp. sq. error for p=0.833333333333333 
##                                0.01984 
## [1] &quot;new solution&quot;
## pest for 0 heads pest for 1 heads pest for 2 heads pest for 3 heads 
##          0.03191          0.11184          0.29667          0.43917 
## pest for 4 heads pest for 5 heads pest for 6 heads pest for 7 heads 
##          0.56083          0.70333          0.88816          0.96809 
## [1] &quot;new solution losses&quot;
## exp. sq. error for p=0.166666666666667 
##                                0.01904 
## exp. sq. error for p=0.333333333333333 
##                                0.03269 
##               exp. sq. error for p=0.5 
##                                0.03549 
## exp. sq. error for p=0.666666666666667 
##                                0.03269 
## exp. sq. error for p=0.833333333333333 
##                                0.01904 
## [1] &quot;new solution bias checks&quot;
## bias for p=0.166666666666667 bias for p=0.333333333333333 
##                    2.776e-17                    1.110e-16 
##               bias for p=0.5 bias for p=0.666666666666667 
##                    0.000e+00                    0.000e+00 
## bias for p=0.833333333333333 
##                    0.000e+00 
## [1] &quot;new solution max loss improvement&quot;
## [1] 0.000222
## [1] &quot;new solution individual loss changes&quot;
## exp. sq. error for p=0.166666666666667 
##                              0.0007983 
## exp. sq. error for p=0.333333333333333 
##                             -0.0009417 
##               exp. sq. error for p=0.5 
##                              0.0002220 
## exp. sq. error for p=0.666666666666667 
##                             -0.0009417 
## exp. sq. error for p=0.833333333333333 
##                              0.0007983 
## [1] &quot;bayes solution&quot;
## pest for 0 heads pest for 1 heads pest for 2 heads pest for 3 heads 
##           0.2031           0.2514           0.3360           0.4439 
## pest for 4 heads pest for 5 heads pest for 6 heads pest for 7 heads 
##           0.5561           0.6640           0.7486           0.7969 
## [1] &quot;bayes losses&quot;
## exp. sq. error for p=0.166666666666667 
##                                0.01878 
## exp. sq. error for p=0.333333333333333 
##                                0.01726 
##               exp. sq. error for p=0.5 
##                                0.01868 
## exp. sq. error for p=0.666666666666667 
##                                0.01726 
## exp. sq. error for p=0.833333333333333 
##                                0.01878 
## [1] &quot;sum bayes losses&quot;
## [1] 0.09076
## [1] &quot;max bayes losses&quot;
## [1] 0.01878
## [1] &quot;&quot;
## [1] &quot;polished max soln&quot;
## pest for 0 heads pest for 1 heads pest for 2 heads pest for 3 heads 
##           0.1900           0.2275           0.3455           0.4577 
## pest for 4 heads pest for 5 heads pest for 6 heads pest for 7 heads 
##           0.5423           0.6545           0.7725           0.8100 
## [1] &quot;polished max losses&quot;
## exp. sq. error for p=0.166666666666667 
##                                0.01841 
## exp. sq. error for p=0.333333333333333 
##                                0.01839 
##               exp. sq. error for p=0.5 
##                                0.01843 
## exp. sq. error for p=0.666666666666667 
##                                0.01839 
## exp. sq. error for p=0.833333333333333 
##                                0.01841 
## [1] &quot;polished max losses max&quot;
## [1] 0.01843
## [1] &quot;polished max improvement&quot;
## [1] 0.0003476
## [1] &quot;&quot;
## [1] &quot;polished sum soln&quot;
## pest for 0 heads pest for 1 heads pest for 2 heads pest for 3 heads 
##           0.2031           0.2514           0.3360           0.4439 
## pest for 4 heads pest for 5 heads pest for 6 heads pest for 7 heads 
##           0.5561           0.6640           0.7486           0.7969 
## [1] &quot;polished sum losses&quot;
## exp. sq. error for p=0.166666666666667 
##                                0.01878 
## exp. sq. error for p=0.333333333333333 
##                                0.01726 
##               exp. sq. error for p=0.5 
##                                0.01868 
## exp. sq. error for p=0.666666666666667 
##                                0.01726 
## exp. sq. error for p=0.833333333333333 
##                                0.01878 
## [1] &quot;polished sum losses sum&quot;
## [1] 0.09076
## [1] &quot;polished sum improvement&quot;
## [1] 0</code></pre>
