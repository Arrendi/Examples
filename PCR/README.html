<p>R markdown or &quot;knitr&quot; files to produce Dr. Nina Zumel's Win-Vector LLC articles:</p>
<ul>
<li><a href="http://www.win-vector.com/blog/2016/05/pcr_part1_xonly/">Principal Components Regression, Pt. 1: The Standard Method</a> (<a href="XonlyPCA.Rmd">R markdown source</a>, <a href="XonlyPCA.md">rendered markdown</a>).</li>
<li><a href="http://www.win-vector.com/blog/2016/05/pcr_part2_yaware/">Principal Components Regression, Pt. 2: Y-Aware Methods</a> (<a href="YAwarePCA.Rmd">R markdown source</a>, <a href="YAwarePCA.md">rendered markdown</a>).</li>
<li><a href="http://www.win-vector.com/blog/2016/05/pcr_part3_pickk/">Principal Components Regression, Pt. 3: Picking the Number of Components</a> (<a href="YAwarePCR_pickK.Rmd">R markdown source</a>, <a href="YAwarePCR_pickK.md">rendered markdown</a>).</li>
</ul>
<p>If you are trying to download the worksheets from <a href="https://github.com/WinVector/Examples/tree/master/PCR">here</a> we have (with the help of reader feedback) worked on some instructions to help through the install process <a href="http://www.win-vector.com/blog/2016/05/installing-wvplots-and-knitting-r-markdown/" class="uri">http://www.win-vector.com/blog/2016/05/installing-wvplots-and-knitting-r-markdown/</a>.</p>
<hr />
<p>Win-Vector LLC's Dr. Nina Zumel has a three part series on Principal Components Regression that we think is well worth your time.</p>
<hr />
<h1 id="part-1-principal-components-regressionanalysis-the-standard-methods">Part 1 Principal Components Regression/Analysis: The Standard Methods</h1>
<p>You can read her first article <a href="http://www.win-vector.com/blog/2016/05/pcr_part1_xonly">part 1 here</a>. Principal Components Regression (PCR) is the use of Principal Components Analysis (PCA) as a dimension reduction step prior to linear regression. It is one of the best known dimensionality reduction techniques and a staple procedure in many scientific fields. PCA is used because:</p>
<ul>
<li>It can find important latent structure and relations.</li>
<li>It can reduce over fit.</li>
<li>It can ease the curse of dimensionality.</li>
<li>It is used in a ritualistic manner in many scientific disciplines. In some fields it is considered ignorant and uncouth to regress using original variables.</li>
</ul>
<p>We often find ourselves having to often remind readers that this last reason is not actually positive. The standard derivation of PCA involves trotting out the math and showing the determination of eigenvector directions. It yields visually attractive diagrams such as the following.</p>
<p><a href="https://en.wikipedia.org/wiki/Principal_component_analysis#/media/File:GaussianScatterPCA.svg"><img width="500" src="http://www.win-vector.com/blog/wp-content/uploads/2016/05/GaussianScatterPCA.svg_.png" title="GaussianScatterPCA.svg.png" alt="GaussianScatterPCA svg" /></a></p>
<p>Wikipedia: PCA</p>
<p>And this leads to a deficiency in much of the teaching of the method: glossing over the operational consequences and outcomes of applying the method. The mathematics is important to the extent it allows you to reason about the appropriateness of the method, the consequences of the transform, and the pitfalls of the technique. The mathematics is also critical to the correct implementation, but that is what one hopes is <em>already</em> supplied in a reliable analysis platform (such as <a href="https://cran.r-project.org">R</a>). Dr. Zumel uses the expressive and graphical power of R to work through the <em>use</em> of Principal Components Regression in an operational series of examples. She works through how Principal Components Regression is typically mis-applied and continues on to how to correctly apply it. Taking the extra time to work through the all too common errors allows her to demonstrate and quantify the benefits of correct technique. Dr. Zumel will soon follow <a href="http://www.win-vector.com/blog/2016/05/pcr_part1_xonly">part 1</a> later with a shorter part 2 article demonstrating important &quot;<em>y</em>-aware&quot; techniques that squeeze much more modeling power out of your data in predictive analytic situations (which is what regression actually is). Some of the methods are already in the literature, but are still not used widely enough. We hope the demonstrated techniques and included references will give you a perspective to improve how you use or even teach Principal Components Regression. Please read on <a href="http://www.win-vector.com/blog/2016/05/pcr_part1_xonly">here</a>.</p>
<hr />
<h1 id="part-2-y-aware-methods">Part 2: <em>Y</em>-Aware Methods</h1>
<p>In <a href="http://www.win-vector.com/blog/2016/05/pcr_part2_yaware">part 2</a> of her series on Principal Components Regression Dr. Nina Zumel illustrates so-called <em>y</em>-aware techniques. These often neglected methods use the fact that for predictive modeling problems we know the dependent variable, outcome or <em>y</em>, so we can use this during data preparation <em>in addition to</em> using it during modeling. Dr. Zumel shows the incorporation of <em>y</em>-aware preparation into Principal Components Analyses can capture more of the problem structure in fewer variables. Such methods include:</p>
<ul>
<li>Effects based variable pruning</li>
<li>Significance based variable pruning</li>
<li>Effects based variable scaling.</li>
</ul>
<p>This recovers more domain structure and leads to better models. Using the foundation set in the first article Dr. Zumel quickly shows how to move from a traditional <em>x</em>-only analysis that fails to preserve a domain-specific relation of two variables to outcome to a <em>y</em>-aware analysis that preserves the relation. Or in other words how to move away from a middling result where different values of y (rendered as three colors) are hopelessly intermingled when plotted against the first two found latent variables as shown below.</p>
<div class="figure">
<img width="500" src="http://www.win-vector.com/blog/wp-content/uploads/2016/05/NewImage-1.png" title="NewImage.png" alt="NewImage" />
</div>
<p>Dr. Zumel shows how to perform a decisive analysis where <em>y</em> is somewhat sortable by the each of the first two latent variable <em>and</em> the first two latent variables capture complementary effects, making them good mutual candidates for further modeling (as shown below).</p>
<div class="figure">
<img width="500" src="http://www.win-vector.com/blog/wp-content/uploads/2016/05/NewImage.png" title="NewImage.png" alt="NewImage" />
</div>
<p>Click <a href="http://www.win-vector.com/blog/2016/05/pcr_part2_yaware">here (part 2 <em>y</em>-aware methods)</a> for the discussion, examples, and references. Part 1 (<em>x</em> only methods) can be found <a href="http://www.win-vector.com/blog/2016/05/pcr_part1_xonly">here</a>.</p>
<hr />
<h1 id="part-3-picking-k-and-wrapping-up">Part 3: picking <em>k</em> and wrapping up</h1>
<p>In her series on principal components analysis for regression in <a href="https://cran.r-project.org">R</a> <a href="http://www.win-vector.com/">Win-Vector LLC</a>'s <a href="http://www.win-vector.com/site/staff/nina-zumel/">Dr. Nina Zumel</a> broke the demonstration down into the following pieces:</p>
<ul>
<li><a href="http://www.win-vector.com/blog/2016/05/pcr_part1_xonly/">Part 1</a>: the proper preparation of data and use of principal components analysis (particularly for supervised learning or regression).</li>
<li><a href="http://www.win-vector.com/blog/2016/05/pcr_part2_yaware/">Part 2</a>: the introduction of <em>y</em>-aware scaling to direct the principal components analysis to preserve variation correlated with the outcome we are trying to predict.</li>
<li>And now <a href="http://www.win-vector.com/blog/2016/05/pcr_part3_pickk/">Part 3</a>: how to pick the number of components to retain for analysis.</li>
</ul>
<p>In the earlier parts Dr. Zumel demonstrates common poor practice versus best practice and quantifies the degree of available improvement. In part 3 she moves from the usual &quot;pick the number of components by eyeballing it&quot; non-advice and teaches decisive decision procedures. For picking the number of components to retain for analysis there are a number of standard techniques in the literature including:</p>
<ul>
<li>Pick 2, as that is all you can legibly graph.</li>
<li>Pick enough to cover some fixed fraction of the variation (say 95%).</li>
<li>(for variance scaled data only) Retain components with singular values at least 1.0.</li>
<li>Look for a &quot;knee in the curve&quot; (the curve being the plot of the singular value magnitudes).</li>
<li>Perform a statistical test to see which singular values are larger than we would expect from an appropriate null hypothesis or noise process.</li>
</ul>
<p>Dr. Zumel shows that the last method (designing a formal statistical test) is particularly easy to encode as a permutation test in the <em>y</em>-aware setting (there is also an obvious similarly good bootstrap test). This is well-founded and pretty much state of the art. It is also a great example of why to use a scriptable analysis platform (such as R) as it is easy to wrap arbitrarily complex methods into functions and then directly perform empirical tests on these methods. The following &quot;broken stick&quot; type test yields the following graph which identifies five principal components as being significant:</p>
<div class="figure">
<img width="500" src="http://www.win-vector.com/blog/wp-content/uploads/2016/05/replot-1.png" title="replot-1.png" alt="Replot 1" />
</div>
<p>However, Dr. Zumel goes on to show that in a supervised learning or regression setting we can further exploit the structure of the problem and replace the traditional component magnitude tests with simple model fit significance pruning. The significance method in this case gets the stronger result of finding the two principal components that encode the known even and odd loadings of the example problem:</p>
<div class="figure">
<img width="500" src="http://www.win-vector.com/blog/wp-content/uploads/2016/05/plotsig-1.png" title="plotsig-1.png" alt="Plotsig 1" />
</div>
<p>In fact that is sort of her point: significance pruning either on the original variables or on the derived latent components is enough to give us the right answer. In general we get much better results when (in a supervised learning or regression situation) we use knowledge of the dependent variable (the &quot;<em>y</em>&quot; or outcome) and do <em>all</em> of the following:</p>
<ul>
<li>Model fit significance prune incoming variables.</li>
<li>Convert incoming variables into consistent response units by <em>y</em>-aware scaling.</li>
<li>Model fit significance prune resulting latent components.</li>
</ul>
<p>The above will become much clearer and much more specific if you <a href="http://www.win-vector.com/blog/2016/05/pcr_part3_pickk/">click here to read part 3</a>.</p>
